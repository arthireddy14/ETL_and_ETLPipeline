A global environmental analytics company, AtmosTrack, wants to build an automated Air Quality Monitoring system that collects hourly pollutant readings for major Indian metro cities. The company wants to analyze pollution trends, assess risk levels, and generate daily reports for internal dashboards.
AtmosTrack has chosen the Open-Meteo Air Quality API, which is free and does not require tokens.
You are required to build a complete ETL Pipeline (Extract → Transform → Load → Analyze) using Python.
 
1️⃣ Extract (extract.py)
Use the following API endpoint:
https://air-quality-api.open-meteo.com/v1/air-quality
    ?latitude=<lat>
    &longitude=<lon>
    &hourly=pm10,pm2_5,carbon_monoxide,nitrogen_dioxide,ozone,sulphur_dioxide,uv_index
Cities to fetch (with coordinates):
City	Latitude	Longitude
Delhi	28.7041	77.1025
Mumbai	19.0760	72.8777
Bengaluru	12.9716	77.5946
Hyderabad	17.3850	78.4867
Kolkata	22.5726	88.3639
Extraction Requirements
Fetch hourly pollutant data for all 5 cities.
Each API call must save raw JSON into:
Implement:
Retry logic (3 attempts)
Graceful failure handling
Logging of API errors
Return a list of all saved file paths.
data/raw/<city>_raw_<timestamp>.json
 
2️⃣ Transform (transform.py)
Each city’s JSON must be flattened into tabular format with one row per hour.
A. Required Columns
city
time
pm10
pm2_5
carbon_monoxide
nitrogen_dioxide
sulphur_dioxide
ozone
uv_index
B. Derived Features (Feature Engineering)
1. AQI based on PM2.5
0–50     → Good
51–100   → Moderate
101–200  → Unhealthy
201–300  → Very Unhealthy>300     → Hazardous 
2. Pollution Severity Score
Use weighted pollutants:
severity = (pm2_5 * 5) + (pm10 * 3) +
           (nitrogen_dioxide * 4) + (sulphur_dioxide * 4) +
           (carbon_monoxide * 2) + (ozone * 3)
3. Risk Classification
severity > 400 → "High Risk"severity > 200 → "Moderate Risk" else           → "Low Risk" 
4. Temperature Hour-of-Day Feature (Optional)
Extract hour:
hour = time.hour
C. Transform Requirements
Convert timestamps into datetime format
Convert all pollutant values to numeric
Remove records where all pollutant readings are missing
Save transformed data into:
data/staged/air_quality_transformed.csv
 